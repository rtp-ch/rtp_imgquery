<!DOCTYPE html>
<html>
  <head>
    <title>rtp_imgQuery Tests</title>
    <link rel="stylesheet" href="qunit/qunit.css">
    <script type="text/javascript">
      var imgQry = {};
      imgQry.images = {};
      imgQry.ratios = {};
      imgQry.breakpoints = {};
      
    </script>
  </head>
  <body>
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>
    <script src="qunit/qunit.js" type="text/javascript"></script>
    <script type="text/javascript">
      var imagesIn = {
              "1": {
                  "400" : '<img src="Images/pixel_ratio_1/300.gif" width="300" height="300">',
                  "800" : '<img src="Images/pixel_ratio_1/600.gif" width="600" height="600">',
                  "1200" : '<img src="Images/pixel_ratio_1/800.gif" width="800" height="800">'
              },
              "1.5": {
                  "400" : '<img src="Images/pixel_ratio_1_5/300.gif" width="300" height="300">',
                  "800" : '<img src="Images/pixel_ratio_1_5/600.gif" width="600" height="600">',
                  "1200" : '<img src="Images/pixel_ratio_1_5/800.gif" width="800" height="800">'
              },
              "2": {
                  "400" : '<img src="Images/pixel_ratio_2/300.gif" width="300" height="300">',
                  "800" : '<img src="Images/pixel_ratio_2/600.gif" width="600" height="600">',
                  "1200" : '<img src="Images/pixel_ratio_2/800.gif" width="800" height="800">'
              }
      },
          breakpointsIn = [400,800,1200],
          ratiosIn = [1,1.5,2],
          cacheKeyIn = JSON.stringify(imagesIn);
          
      // Device Pixel ratio
      imgQry.ratios = {};
      imgQry.ratio = 1;
      
      // Window width
      imgQry.width = 700;
      
    </script><script type="text/javascript">({write:function(a){"complete"!==document.readyState&&document.write(a)},closest:function(a,b){"use strict";for(var c=a.length,d=0;c>d&&!(a[d]>=b);)d+=1;return d=d===c?c-1:d},sort:function(a,b){"use strict";return b>a?-1:b>a?1:0},imgQry:function(a,b,c,d,e){"use strict";b=b.sort(this.sort),d=d.sort(this.sort),"undefined"==typeof a.imgQry&&(a.imgQry={}),"undefined"==typeof a.imgQry.images&&(a.imgQry.images={}),"undefined"==typeof a.imgQry.ratios&&(a.imgQry.ratios={}),"undefined"==typeof a.imgQry.breakpoints&&(a.imgQry.breakpoints={}),"undefined"==typeof a.imgQry.width&&(a.imgQry.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0),"undefined"==typeof a.imgQry.ratio&&(a.imgQry.ratio="undefined"!=typeof a.devicePixelRatio?a.devicePixelRatio:1),"undefined"==typeof a.imgQry.ratios[d]&&(a.imgQry.ratios[d]=d[this.closest(d,a.imgQry.ratio)]),"undefined"==typeof a.imgQry.breakpoints[b]&&(a.imgQry.breakpoints[b]=b[this.closest(b,a.imgQry.width)]),"undefined"==typeof a.imgQry.images[e]&&(a.imgQry.images[e]=c[a.imgQry.ratios[d]][a.imgQry.breakpoints[b]]),this.write(a.imgQry.images[e])}}).imgQry(this,breakpointsIn,imagesIn,ratiosIn,cacheKeyIn);</script>
    <script type="text/javascript">
      test('Normal image selection for window width 700', function() {
          var actualImage = imgQry.images[cacheKeyIn],
              expectedImage = imagesIn["1"]["800"];
          equal(actualImage, expectedImage, 'Expected first image for pixel ratio 1');
      });
    </script>
  </body>
</html>